{"version":3,"sources":["pages/AccessManage/Menu/AddOrEditRoleModel.js","pages/AccessManage/Menu/index.js"],"names":["FormItem","es_form","Item","formItemLayout","labelCol","span","wrapperCol","style","paddingLeft","AddOrEditRole","sureAction","_this","props","form","validateFields","err","values","onOk","getFieldDecorator","this","activeData","isEditor","undefined","isHasUrl","subMenus","length","_react_16_6_3_react_default","a","createElement","MainModal","title","visible","onCancel","okText","cancelText","Object","assign","label","rules","required","message","initialValue","name","input","placeholder","url","seq","TextArea","resize","height","Component","AddOrEditRoleModel","create","TreeNode","tree","iconStyle","fontSize","color","marginLeft","iconActiveStyle","Menu","state","menuLists","selectedKeys","expandedKeys","getMenuLists","res","success","msg","obj","id","parentId","iconUrl","iconSelectedUrl","tags","errorCode","setState","onSelect","info","node","detail","onDragEnter","onDrop","deleteAction","modal","confirm","concat","error","saveAction","data","sourceCode","_this2","padding","card","lineHeight","extra","es_button","icon","type","disabled","marginRight","onClick","defaultExpandedKeys","draggable","loop","map","item","key","Menu_AddOrEditRoleModel","React"],"mappings":"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","file":"static/js/21.9901c941.chunk.js","sourcesContent":["/**\r\n * Created by hutao on 2018/8/31.\r\n * 权限配置\r\n */\r\nimport React, { Component } from 'react';\r\nimport { Form, Input } from 'antd';\r\nimport MainModal from '@/common/components/MainModal';\r\n\r\nconst FormItem = Form.Item;\r\nconst formItemLayout = {\r\n    labelCol: { span: 4 },\r\n    wrapperCol: { span: 19, style:{paddingLeft:'10px'}},\r\n};\r\n\r\nclass AddOrEditRole extends Component {\r\n    sureAction = () => {\r\n        this.props.form.validateFields(\r\n            (err,values) => {\r\n                if (!err) {\r\n                    this.props.onOk(values);\r\n                }\r\n            },\r\n        );\r\n    }\r\n\trender () {\r\n        const { getFieldDecorator } = this.props.form;\r\n        let activeData = this.props.isEditor ? this.props.activeData: undefined;\r\n        let isHasUrl = !activeData || activeData.subMenus.length===0;\r\n\t\treturn (\r\n\t\t\t<MainModal\r\n                title={this.props.title}\r\n                visible={true}\r\n                onOk={this.sureAction}\r\n                onCancel={this.props.onCancel}\r\n                okText=\"确定\"\r\n                cancelText=\"取消\"\r\n            >\r\n                <FormItem {...formItemLayout} label=\"名称\">\r\n                    {getFieldDecorator('name', {\r\n                        rules: [{\r\n                            required: true,\r\n                            message: '请输入菜单名称'\r\n                        }],\r\n                        initialValue: activeData&&activeData.name\r\n                    })(\r\n                        <Input placeholder=\"请输入菜单名称\" />\r\n                    )}\r\n                </FormItem>\r\n                {isHasUrl?\r\n                    <FormItem {...formItemLayout} label=\"URL\">\r\n                        {getFieldDecorator('url', {\r\n                            rules: [{\r\n                                required: true,\r\n                                message: '请输入路由地址'\r\n                            }],\r\n                            initialValue: activeData&&activeData.url\r\n                        })(\r\n                            <Input placeholder=\"请输入路由地址\"/>\r\n                        )}\r\n                    </FormItem>:null\r\n                }\r\n                <FormItem {...formItemLayout} label=\"排序\">\r\n                    {getFieldDecorator('seq', {\r\n                        rules: [{\r\n                            required: true,\r\n                            message: '请输入排序'\r\n                        }],\r\n                        initialValue: activeData&&activeData.seq\r\n                    })(\r\n                        <Input.TextArea style={{resize:'none',height:60}} placeholder=\"请输入排序\"/>\r\n                    )}\r\n                </FormItem>\r\n            </MainModal>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nconst AddOrEditRoleModel = Form.create()(AddOrEditRole);\r\nexport default AddOrEditRoleModel;","import React from 'react';\r\nimport { Card, Tree, Button, Icon, Modal, message } from 'antd';\r\nimport AddOrEditRoleModel from './AddOrEditRoleModel'\r\n\r\nconst TreeNode = Tree.TreeNode;\r\n\r\nconst iconStyle = {\r\n\tfontSize: '20px',\r\n\tcolor: '#aaa',\r\n\tmarginLeft: '10px'\r\n}\r\nconst iconActiveStyle = Object.assign({},iconStyle,{color:'rgb(24, 144, 255)'});\r\n\r\nclass Menu extends React.Component {\r\n\tstate = {\r\n\t\tmenuLists: [], //菜单列表\r\n\t\tselectedKeys: [], //选中节点\r\n\t\texpandedKeys: [], //展开节点\r\n\t\tvisible: false, //是否显示新增或修改模态框\r\n\t\tisEditor: false, //是否修改\r\n\t\tactiveData: undefined, //选中节点信息\r\n\t}\r\n\tcomponentWillMount() {\r\n\t\tthis.getMenuLists();\r\n\t}\r\n\t//获取菜单列表\r\n\tgetMenuLists = () => {\r\n\t\tconst res = {\r\n\t\t\t\"success\": true,\r\n\t\t\t\"msg\": \"成功\",\r\n\t\t\t\"obj\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"id\": 150,\r\n\t\t\t\t\t\"parentId\": -1,\r\n\t\t\t\t\t\"name\": \"综合画像\",\r\n\t\t\t\t\t\"url\": \"\",\r\n\t\t\t\t\t\"iconUrl\": \"n_ico2.png\",\r\n\t\t\t\t\t\"iconSelectedUrl\": \"n_ico2.png\",\r\n\t\t\t\t\t\"seq\": 11,\r\n\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\"subMenus\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"id\": 151,\r\n\t\t\t\t\t\t\t\"parentId\": 150,\r\n\t\t\t\t\t\t\t\"name\": \"群体画像\",\r\n\t\t\t\t\t\t\t\"url\": \"/mainframe/GroupPortrait\",\r\n\t\t\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\t\t\"seq\": 12,\r\n\t\t\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\t\t\"subMenus\": []\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"id\": 152,\r\n\t\t\t\t\t\t\t\"parentId\": 150,\r\n\t\t\t\t\t\t\t\"name\": \"个人画像\",\r\n\t\t\t\t\t\t\t\"url\": \"/mainframe/personalportrait\",\r\n\t\t\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\t\t\"seq\": 13,\r\n\t\t\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\t\t\"subMenus\": []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\t\"id\": 2,\r\n\t\t\t\t\t\"parentId\": -1,\r\n\t\t\t\t\t\"name\": \"轨迹分析\",\r\n\t\t\t\t\t\"url\": \"\",\r\n\t\t\t\t\t\"iconUrl\": \"n_ico3.png\",\r\n\t\t\t\t\t\"iconSelectedUrl\": \"n_ico3.png\",\r\n\t\t\t\t\t\"seq\": 14,\r\n\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\"subMenus\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"id\": 4,\r\n\t\t\t\t\t\t\t\"parentId\": 2,\r\n\t\t\t\t\t\t\t\"name\": \"个人轨迹\",\r\n\t\t\t\t\t\t\t\"url\": \"/mainframe/personalpath\",\r\n\t\t\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\t\t\"seq\": 58,\r\n\t\t\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\t\t\"subMenus\": []\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"id\": 153,\r\n\t\t\t\t\t\t\t\"parentId\": 2,\r\n\t\t\t\t\t\t\t\"name\": \"群体轨迹\",\r\n\t\t\t\t\t\t\t\"url\": \"/mainframe/grouppath\",\r\n\t\t\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\t\t\"seq\": 59,\r\n\t\t\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\t\t\"subMenus\": []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\t\"id\": 178,\r\n\t\t\t\t\t\"parentId\": -1,\r\n\t\t\t\t\t\"name\": \"综合预警\",\r\n\t\t\t\t\t\"url\": \"/mainframe/comprehensivewarning\",\r\n\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\"seq\": 256,\r\n\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\"subMenus\": []\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\t\"id\": 179,\r\n\t\t\t\t\t\"parentId\": -1,\r\n\t\t\t\t\t\"name\": \"系统设置\",\r\n\t\t\t\t\t\"url\": \"/mainframe/systemsetup\",\r\n\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\"seq\": 257,\r\n\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\"subMenus\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"id\": 180,\r\n\t\t\t\t\t\t\t\"parentId\": 179,\r\n\t\t\t\t\t\t\t\"name\": \"预警设置\",\r\n\t\t\t\t\t\t\t\"url\": \"/mainframe/systemsetup/earlywarningsetting\",\r\n\t\t\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\t\t\"seq\": 387,\r\n\t\t\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\t\t\"subMenus\": []\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"id\": 181,\r\n\t\t\t\t\t\t\t\"parentId\": 179,\r\n\t\t\t\t\t\t\t\"name\": \"行为轨迹设置\",\r\n\t\t\t\t\t\t\t\"url\": \"/mainframe/systemsetup/behaviortrajectory\",\r\n\t\t\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\t\t\"seq\": 388,\r\n\t\t\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\t\t\"subMenus\": []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\t\"id\": 10,\r\n\t\t\t\t\t\"parentId\": -1,\r\n\t\t\t\t\t\"name\": \"权限管理\",\r\n\t\t\t\t\t\"url\": \"\",\r\n\t\t\t\t\t\"iconUrl\": \"xitongguanli.png\",\r\n\t\t\t\t\t\"iconSelectedUrl\": \"xitongguanli2.png\",\r\n\t\t\t\t\t\"seq\": 259,\r\n\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\"subMenus\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"id\": 25,\r\n\t\t\t\t\t\t\t\"parentId\": 10,\r\n\t\t\t\t\t\t\t\"name\": \"账户管理\",\r\n\t\t\t\t\t\t\t\"url\": \"/mainframe/accessmanage/account\",\r\n\t\t\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\t\t\"seq\": 264,\r\n\t\t\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\t\t\"subMenus\": []\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"id\": 24,\r\n\t\t\t\t\t\t\t\"parentId\": 10,\r\n\t\t\t\t\t\t\t\"name\": \"菜单管理\",\r\n\t\t\t\t\t\t\t\"url\": \"/mainframe/accessmanage/menu\",\r\n\t\t\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\t\t\"seq\": 265,\r\n\t\t\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\t\t\"subMenus\": []\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"id\": 26,\r\n\t\t\t\t\t\t\t\"parentId\": 10,\r\n\t\t\t\t\t\t\t\"name\": \"权限配置\",\r\n\t\t\t\t\t\t\t\"url\": \"/mainframe/accessmanage/authority\",\r\n\t\t\t\t\t\t\t\"iconUrl\": \"\",\r\n\t\t\t\t\t\t\t\"iconSelectedUrl\": \"\",\r\n\t\t\t\t\t\t\t\"seq\": 266,\r\n\t\t\t\t\t\t\t\"tags\": [],\r\n\t\t\t\t\t\t\t\"subMenus\": []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\t\"errorCode\": null\r\n\t\t}\r\n\t\tif (res.success) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tmenuLists: res.obj || []\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t//选中节点修改\r\n\tonSelect = (selectedKeys, info) => {\r\n\t\tif(selectedKeys.length>0){\r\n\t\t\tthis.setState({ selectedKeys, activeData: info.node.props.detail });\r\n\t\t} else {\r\n\t\t\tthis.setState({ selectedKeys, activeData: undefined });\r\n\t\t}\r\n\t}\r\n\t//拖拽开始\r\n\tonDragEnter = (info) => {\r\n\t\t// expandedKeys 需要受控时设置\r\n\t\tthis.setState({\r\n\t\t  expandedKeys: info.expandedKeys,\r\n\t\t});\r\n\t}\r\n\t//拖拽中\r\n\tonDrop = (info) => {\r\n\t\t// 拖拽限制处理以及获取拖拽节点的id和父节点id以及计算\r\n\t\t// console.log(info.dragNode)\r\n\t\t// let dragNodeDetail = info.dragNode.props.detail;//拖动节点\r\n\t\t// let dropNodeDetail = info.node.props.detail;//放置节点\r\n\r\n\t\t// const dropKey = info.node.props.eventKey; //放置节点id\r\n\t\t// const dragKey = info.dragNode.props.eventKey; //拖动节点id\r\n\t\t// const dropPos = info.node.props.pos.split('-');\r\n\r\n\t\t// //如果是父节点不能拖动到别人节点里面\r\n\t\t\r\n\t\t// if(dragNodeDetail && dragNodeDetail.parentId<=0 && dragNodeDetail.subMenus.length>0 &&(dropPos.length>2 || !info.dropToGap)){\r\n\t\t// \tmessage.warn('不能移动有子节点的节点！');\r\n\t\t// \treturn;\r\n\t\t// }\r\n\t\t// //限制不能拖动到子节点上\r\n\t\t// if(!info.dropToGap && dropPos.length>2){\r\n\t\t// \treturn;\r\n\t\t// }\r\n\t\t// const dropPosition = info.dropPosition - Number(dropPos[dropPos.length - 1]);\r\n\t\t// //参数\r\n\t\t// let targetSeq,targetParentId,id=dragKey;\r\n\t\t// if(dropPos.length===2 && !info.dropToGap){\r\n\t\t// \ttargetParentId = dropKey;\r\n\t\t// \ttargetSeq = dropNodeDetail.seq+1;\r\n\t\t// } else if(dropPos.length>2){\r\n\t\t// \ttargetParentId = dropNodeDetail.parentId;\r\n\t\t// \ttargetSeq = dropNodeDetail.seq+dropPosition;\r\n\t\t// } else if(dropPos.length===2 && info.dropToGap){\r\n\t\t// \ttargetParentId = -1;\r\n\t\t// \ttargetSeq = dropNodeDetail.seq+dropPosition;\r\n\t\t// }\r\n\r\n\t\t// console.log(dropPos.length,dropPosition,info.dropToGap,targetSeq,targetParentId,id)\r\n\t\t//拖动后请求接口改变菜单的排序\r\n\t\t\r\n\t}\r\n\r\n\t//删除菜单\r\n    deleteAction = () => {\r\n\t\tif(this.state.activeData){\r\n\t\t\tModal.confirm({\r\n\t\t\t\ttitle: `确定删除${this.state.activeData.name}菜单吗?`,\r\n\t\t\t\tonOk:()=> {\r\n\t\t\t\t\t//处理删除功能,根据返回结果处理\r\n\t\t\t\t\t// let data = {\r\n\t\t\t\t\t// \tid: this.state.activeData.id\r\n\t\t\t\t\t// }\r\n\r\n\t\t\t\t\tconst res = {\r\n\t\t\t\t\t\tsuccess:true\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(res.success){\r\n\t\t\t\t\t\tmessage.success('删除成功！');\r\n\t\t\t\t\t\tthis.getMenuLists();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmessage.error(res.obj);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonCancel() {},\r\n\t\t\t\tokText:'确定',\r\n\t\t\t\tcancelText:'取消',\r\n\t\t\t});\r\n\t\t}\r\n    }\r\n\t//编辑和新增确定时保存角色信息\r\n\tsaveAction = (values) => {\r\n\t\tlet isEditor = this.state.isEditor;\r\n        let { name, seq, url } = values;\r\n        let data = {name, seq, url, sourceCode: 'pc',iconUrl:'test',iconSelectedUrl:'test'};\r\n        // let reqUrl = '/bigdata/system/menu/save'; //新增时的角色保存接口\r\n        if(isEditor){ //编辑角色时修改请求接口、添加角色id参数\r\n            // reqUrl = '/bigdata/system/menu/update';\r\n            data.id = this.state.activeData.id\r\n\t\t} else if(this.state.activeData && this.state.activeData.parentId<=0) {\r\n\t\t\tdata.parentId = this.state.activeData.id;\r\n\t\t}\r\n\t\t//保存操作，根据结果进行界面处理\r\n\t\tconst res = {\r\n\t\t\tsuccess: true\r\n\t\t}\r\n        if(res.success){\r\n\t\t\tmessage.success('保存成功！');\r\n\t\t\tthis.setState({visible:false,isEditor:false},()=>{\r\n\t\t\t\tthis.getMenuLists();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tmessage.error(res.obj);\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\t//递归菜单列表\r\n\t\tconst loop = data => data.map((item) => {\r\n\t\t\tif (item.subMenus && item.subMenus.length) {\r\n\t\t\t\treturn <TreeNode key={item.id} title={item.name} detail={item}>{loop(item.subMenus)}</TreeNode>;\r\n\t\t\t}\r\n\t\t\treturn <TreeNode key={item.id} title={item.name} detail={item}/>;\r\n\t\t});\r\n\t\treturn (\r\n\t\t\t<div style={{ padding: '20px' }}>\r\n\t\t\t\t<Card\r\n\t\t\t\t\ttitle={<span style={{ color: '#1890FF', lineHeight: '34px' }}>菜单</span>}\r\n\t\t\t\t\textra={<div>\r\n\t\t\t\t\t\t<Button icon=\"plus\" type=\"primary\" disabled={this.state.activeData&&this.state.activeData.parentId>0} style={{ marginRight: 20 }} onClick={()=>{\r\n\t\t\t\t\t\t\tthis.setState({visible:true,isEditor:false})\r\n\t\t\t\t\t\t}}>添加菜单</Button>\r\n\t\t\t\t\t\t<Icon type=\"form\" style={this.state.activeData?iconActiveStyle:iconStyle} onClick={()=>{\r\n\t\t\t\t\t\t\tif(this.state.activeData){\r\n\t\t\t\t\t\t\t\tthis.setState({visible:true,isEditor:true})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t<Icon type=\"delete\" style={this.state.activeData?iconActiveStyle:iconStyle} onClick={this.deleteAction} />\r\n\t\t\t\t\t</div>}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Tree\r\n\t\t\t\t\t\tonSelect={this.onSelect}\r\n\t\t\t\t\t\tselectedKeys={this.state.selectedKeys}\r\n\t\t\t\t\t\tdefaultExpandedKeys={this.state.expandedKeys}\r\n\t\t\t\t\t\tdraggable\r\n\t\t\t\t\t\tonDragEnter={this.onDragEnter}\r\n\t\t\t\t\t\tonDrop={this.onDrop}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{loop(this.state.menuLists)}\r\n\t\t\t\t\t</Tree>\r\n\t\t\t\t</Card>\r\n\t\t\t\t{this.state.visible?(\r\n                    <AddOrEditRoleModel\r\n                        title={this.state.isEditor?'编辑菜单':'新建菜单'}\r\n\t\t\t\t\t\tvisible={this.state.visible}\r\n\t\t\t\t\t\tisEditor={this.state.isEditor}\r\n                        onOk={this.saveAction}\r\n                        activeData={this.state.activeData}\r\n                        onCancel={()=>this.setState({visible:false,isEditor:false})}\r\n                    />\r\n                ):null}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default Menu;"],"sourceRoot":""}